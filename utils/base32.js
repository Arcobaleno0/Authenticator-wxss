"use strict";function Decoder(r){if(this.buf=[],this.shift=8,this.carry=0,r){switch(r.type){case"rfc4648":this.charmap=exports.rfc4648.charmap;break;case"crockford":this.charmap=exports.crockford.charmap;break;default:throw new Error("invalid type")}r.charmap&&(this.charmap=r.charmap)}}function Encoder(r){if(this.buf="",this.shift=3,this.carry=0,r){switch(r.type){case"rfc4648":this.alphabet=exports.rfc4648.alphabet;break;case"crockford":this.alphabet=exports.crockford.alphabet;break;default:throw new Error("invalid type")}r.alphabet?this.alphabet=r.alphabet:r.lc&&(this.alphabet=this.alphabet.toLowerCase())}}var Buffer=require("./Buffer.js").Buffer,charmap=function(r,t){return t||(t={}),r.split("").forEach(function(r,a){r in t||(t[r]=a)}),t},rfc4648={alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",charmap:{0:14,1:8}};rfc4648.charmap=charmap(rfc4648.alphabet,rfc4648.charmap);var crockford={alphabet:"0123456789ABCDEFGHJKMNPQRSTVWXYZ",charmap:{O:0,I:1,L:1}};crockford.charmap=charmap(crockford.alphabet,crockford.charmap),Decoder.prototype.charmap=rfc4648.charmap,Decoder.prototype.write=function(r){var t=this.charmap,a=this.buf,e=this.shift,h=this.carry;return r.toUpperCase().split("").forEach(function(r){if("="!=r){var c=255&t[r];e-=5,e>0?h|=c<<e:0>e?(a.push(h|c>>-e),e+=8,h=c<<e&255):(a.push(h|c),e=8,h=0)}}),this.shift=e,this.carry=h,this},Decoder.prototype.finalize=function(r){return r&&this.write(r),8!==this.shift&&0!==this.carry&&(this.buf.push(this.carry),this.shift=8,this.carry=0),new Buffer(this.buf)},Encoder.prototype.alphabet=rfc4648.alphabet,Encoder.prototype.write=function(r){var t,a,e,h=this.shift,c=this.carry;for(e=0;e<r.length;e++)a=r[e],t=c|a>>h,this.buf+=this.alphabet[31&t],h>5&&(h-=5,t=a>>h,this.buf+=this.alphabet[31&t]),h=5-h,c=a<<h,h=8-h;return this.shift=h,this.carry=c,this},Encoder.prototype.finalize=function(r){return r&&this.write(r),3!==this.shift&&(this.buf+=this.alphabet[31&this.carry],this.shift=3,this.carry=0),this.buf},exports.encode=function(r,t){return new Encoder(t).finalize(r)},exports.decode=function(r,t){return new Decoder(t).finalize(r)},exports.Decoder=Decoder,exports.Encoder=Encoder,exports.charmap=charmap,exports.crockford=crockford,exports.rfc4648=rfc4648;